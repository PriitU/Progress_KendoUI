webpackJsonp([0],{386:function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=o(6),r=n(i),a=o(404),s=(n(a),o(418)),d=n(s),l=o(419),c=n(l),u=o(444),h=n(u),f=o(443),p=n(f),v=o(447),m=n(v),$=o(445),b=n($),g=o(446),y=n(g);t.default=r.default.module("views.customer.view-customer-history",[]).controller("CustomerViewCustomerHistoryCtrl",d.default).factory("customerViewCustomerHistory",c.default).run(["$templateCache",function(e){e.put("views.customer.view-customer-history.bottomSection.html",h.default),e.put("views.customer.view-customer-history.bottomChildSection.html",p.default),e.put("views.customer.view-customer-history.topSection.html",m.default),e.put("views.customer.view-customer-history.topChildSection.html",b.default),e.put("views.customer.view-customer-history.topParentSection.html",y.default)}]).name},404:function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),r=function(){function e(t,o){var i=this;n(this,e),this.$scope=t,this.$dataProviderService=o.get("providerService"),this.$dsService=o.get("dsService"),this.$compile=o.get("$compile"),this.$childDataSources=[],this.$childGrids=[],this.$window=o.get("$window"),this.$pendingChangeMessage="There are unsaved changes. Do you want to complete the changes before continuing?";var r=this;this.$parentDs=new kendo.data.DataSource({transport:this.$dataProviderService.getTransport("ProjectData",{jsdo:"beViewCustomerHistory",tableRef:"ttCustomer"}),requestStart:function(e){r._$childDataSourcesHasChanges()&&confirm(r.$pendingChangeMessage)&&e.preventDefault()},type:"jsdo",pageSize:10}),"progress-data-provider"===this.$dataProviderService.dataProviders.ProjectData.type&&(this.$jsdoInstance=new progress.data.JSDO({name:"beViewCustomerHistory"}),this.$parentDs.transport.jsdo=this.$jsdoInstance),this.$parentDs.bind("error",this._$errorHandler.bind(this)),this.$model={parentField:"CustomerId",childField:"CustomerId",parentTitle:"Customers",childTitle:"Customer History",parentGridOptions:{detailInit:function(e){i.$model.parentGridEvents.onDetailInit(e)},pageable:{pageSize:10,refresh:!0},filterable:!1,groupable:!1,resizable:!1,reorderable:!1,sortable:!1,selectable:!0,columns:[{encoded:!0,field:"IdCode",filterable:!0,format:"",sortable:!0,title:"IdCode"},{encoded:!0,field:"FirstName",filterable:!0,format:"",sortable:!0,title:"FirstName"},{encoded:!0,field:"LastName",filterable:!0,format:"",sortable:!0,title:"LastName"}],dataSource:this.$parentDs},childGridOptions:{pageable:{pageSize:5,refresh:!0},messages:{commands:{cancel:"Cancel changes",create:"New",save:"Save changes",canceledit:"Cancel",destroy:"Delete",edit:"Edit",update:"Update"}},editable:"inline",filterable:!1,groupable:!1,resizable:!1,reorderable:!1,sortable:!1,columns:[{encoded:!0,field:"CustomerHistoryId",filterable:!0,format:"",sortable:!0,title:"CustomerHistoryId"},{encoded:!0,field:"CustomerId",filterable:!0,format:"",sortable:!0,title:"CustomerId"},{encoded:!0,field:"FirstName",filterable:!0,format:"",sortable:!0,title:"FirstName"},{encoded:!0,field:"LastName",filterable:!0,format:"",sortable:!0,title:"LastName"},{encoded:!0,field:"IdCode",filterable:!0,format:"",sortable:!0,title:"IdCode"},{encoded:!0,field:"Edit",filterable:!0,format:"",sortable:!0,title:"Edit"}],dataSource:null,selectable:"row"},customSections:{top:"views.customer.view-customer-history.topSection.html",topParent:"views.customer.view-customer-history.topParentSection.html",topChild:"views.customer.view-customer-history.topChildSection.html",bottomChild:"views.customer.view-customer-history.bottomChildSection.html",bottom:"views.customer.view-customer-history.bottomSection.html"},parentGridEvents:{onDetailInit:function(e){i._$detailInitHandler(e)},onDetailExpand:function(e){},onDetailCollapse:function(e){},onDataBound:function(e){i._$dataBoundHandler(e)},onRowSelect:function(e){i.onParentRowSelect(e)}},childGridEvents:{onRowSelect:function(e){i.onChildRowSelect(e)},onDataBound:function(e){},onRowCreate:function(e){i._$disableEditButtons(e)},onRowUpdate:function(e){i._$disableEditButtons(e)},onRowDelete:function(e){}}}}return i(e,[{key:"$onInit",value:function(){var e=this;this.$scope.$on("$includeContentLoaded",function(){e.includeContentLoaded&&e.includeContentLoaded()}),this.$scope.$on("$viewContentLoaded",function(t){e.onShow&&e.onShow(t.currentScope)}),this.$scope.$on("$includeContentError",function(t){e.includeContentError&&e.includeContentError(t)}),this.$scope.$on("kendoWidgetCreated",function(t,o){o instanceof kendo.ui.Grid&&e.$parentGrid&&(e.$childGrids.push(o),o.bind("dataBound",e._$enableEditButtons.bind(e)),o.bind("cancel",e._$enableEditButtons.bind(e)))}),this.$scope.$on("$stateChangeStart",this._$routeChange.bind(this)),angular.element(this.$window).on("beforeunload",this._$beforeunloadHandler.bind(this)),this.$scope.$on("$destroy",this._$destroy.bind(this))}},{key:"_$disableEditButtons",value:function(e){e.sender.wrapper.find(".k-grid-add, .k-grid-edit, .k-grid-delete").addClass("kuib-disabled")}},{key:"_$enableEditButtons",value:function(e){e.sender.wrapper.find(".k-grid-add, .k-grid-edit, .k-grid-delete").removeClass("kuib-disabled")}},{key:"_$routeChange",value:function(e){this._$childDataSourcesHasChanges()&&confirm(this.$pendingChangeMessage)&&e.preventDefault()}},{key:"_$beforeunloadHandler",value:function(e){if(this._$childDataSourcesHasChanges())return this.$pendingChangeMessage}},{key:"_$childDataSourcesHasChanges",value:function(){var e=!1;return this.$childDataSources.forEach(function(t){t.hasChanges()&&(e=!0)}),e}},{key:"_$createChildDs",value:function(e){var t=this,o=new kendo.data.DataSource({transport:this.$dataProviderService.getTransport("ProjectData",{jsdo:"beViewCustomerHistory",tableRef:"ttCustomerHistory",readLocal:!0}),requestStart:function(e){"update"!==e.type&&"create"!==e.type&&"submit"!==e.type&&"destroy"!==e.type&&e.sender.hasChanges()&&confirm(t.$pendingChangeMessage)&&e.preventDefault()},filter:this._$getChildFilter(e),type:"jsdo",pageSize:5});return"progress-data-provider"===this.$dataProviderService.dataProviders.ProjectData.type&&(o.transport.jsdo=this.$jsdoInstance),o.bind("error",this._$errorHandler.bind(this)),o.bind("change",this._$changeHandler.bind(this)),this.$childDataSources.push(o),o}},{key:"_$dataBoundHandler",value:function(e){var t=this;this.$scope.$evalAsync(function(){t.$parentGrid.select("tr[data-uid]:eq(0)")})}},{key:"_$detailInitHandler",value:function(e){var t=this,o=angular.element('<div class="row"><div class="col-lg-12"><h2 ng-bind-html="childTitle"></h2></div></div><div class="row"><div class="col-lg-12" ng-include="customSections.topChild"></div></div><div class="row"><div class="col-lg-12"><grid data-options="childGridOptions" data-widget="childGridInstance" data-events="childGridEvents"></grid></div></div><div class="row"><div class="col-lg-12" ng-include="customSections.bottomChild"></div></div>').appendTo(e.detailCell),n=this.$scope.$new();this.$model.childGridOptions.dataSource=this._$createChildDs(e.data),angular.extend(n,this.$model),this.$scope.$applyAsync(function(){t.$compile(o)(n)})}},{key:"_$getChildFilter",value:function(e){return{field:"CustomerId",operator:"eq",value:e.CustomerId}}},{key:"_$errorHandler",value:function(e){var t=this.$dsService.extractErrorMessage(e);this.$scope.$emit("notification",{type:"error",message:t})}},{key:"_$changeHandler",value:function(e){var t=this;if("add"==e.action){var o=e.sender.filter().filters.filter(function(e){return e.field===t.$model.parentField})[0].value;e.items[0].set(this.$model.parentField,o)}}},{key:"_$destroy",value:function(){var e=this;this.$parentDs.unbind("error",this._$errorHandler),this.$childDataSources.forEach(function(t){t.unbind("error",e._$errorHandler),t.unbind("change",e._$changeHandler)}),this.$childGrids.forEach(function(t){t.unbind("dataBound",e._$enableEditButtons),t.unbind("cancel",e._$enableEditButtons)}),angular.element(this.$window).off("beforeunload",this._$beforeunloadHandler)}}]),e}();t.default=r},418:function(e,t,o){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),s=o(404),d=function(e){return e&&e.__esModule?e:{default:e}}(s),l=function(e){function t(e,o,r){return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,o))}return r(t,e),a(t,[{key:"includeContentLoaded",value:function(){}},{key:"includeContentError",value:function(e){}},{key:"onShow",value:function(e){console.log("Show")}},{key:"onParentRowSelect",value:function(e){}},{key:"onChildRowSelect",value:function(e){}}]),t}(d.default);l.$inject=["$scope","$injector","stateData"],t.default=l},419:function(e,t,o){"use strict";function n(e,t){function o(){this.scope=null}return o.prototype={onInit:function(e){return console.log("Init",e),{}},onHide:function(e){console.log("hide",e)}},new o}Object.defineProperty(t,"__esModule",{value:!0}),n.$inject=["$q","dsService"],t.default=n},443:function(e,t){e.exports=""},444:function(e,t){e.exports=""},445:function(e,t){e.exports=""},446:function(e,t){e.exports=""},447:function(e,t){e.exports=""}});